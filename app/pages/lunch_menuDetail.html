<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>main.html</title>

    <link href="/resources/css/common.css" rel="stylesheet" type="text/css" />
    <link href="/resources/css/style.css"  rel="stylesheet" type="text/css"  />
    <link href="/resources/css/miaps.css"  rel="stylesheet" type="text/css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <style>
      .adress_li > input{ 
                  height: 70px;
                  }
    </style>
</head>
<body>
    <header>
        <button class="back_btn"></button><span class="title">메뉴 상세</span>
      </header>
      <div class="contents_wrap">
   
        <ul class="field_wrap">
         
            <li><span>음식점명</span>
              <input type="text" id="restaurant" name="nm" />
            </li>
            <li><span>주소</span>
                <textarea id="address" name="addr" ></textarea>
            </li>
            <li><span>종류</span>
                <input type="text" id="type" name="nm"/>
            </li>
            
        </ul>
        <button type="button" class="main_btn" id="btn_save">저장</button>
        
    </div>

    <script type="text/javascript" src="/resources/js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="/resources/js/handlebars-4.0.11.js"></script>
    
    <script type="text/javascript">
      var connectUrl = "http://58.181.28.53:11199/menu/";

      var getParameters = function (paramName) { // 리턴값을 위한 변수 선언 
      var returnValue; // 현재 URL 가져오기 
      var url = location.href; // get 파라미터 값을 가져올 수 있는 ? 를 기점으로 slice 한 후 split 으로 나눔 
      var parameters = (url.slice(url.indexOf('?') + 1, url.length)).split('&'); // 나누어진 값의 비교를 통해 paramName 으로 요청된 데이터의 값만 
        for (var i = 0; i < parameters.length; i++) { 
          var varName = parameters[i].split('=')[0]; 
          if (varName.toUpperCase() == paramName.toUpperCase()) { 
            returnValue = parameters[i].split('=')[1]; 
            return decodeURIComponent(returnValue); } } 
        };
        
      $(function(){
        $('#restaurant').val(getParameters('name'))
        $('#address').val(getParameters('location'))
        $('#type').val(getParameters('type'))
      });
      
      $('#btn_save').on('click', function(){
         var p_address = $('#address').val();
         var p_name = $('#restaurant').val();
         var p_type = $('#type').val();
         var p_id = getParameters('id');
        
         var modifyData = {};
         modifyData = {"id" : p_id, "location" : p_address, "menuType" : p_type, "name" : p_name};

         $.ajax({ 	
					type : 'POST',
					url: connectUrl + 'modifyMenu', 
					dataType : 'json' ,
					contentType : 'application/json',
					data : JSON.stringify(modifyData),
					success: function(data, textStatus, xhr) { //통신 성공
            console.log(xhr.status);
          },
          complete: function(xhr, textStatus) {
            console.log(xhr.status);
            alert('변경되었습니다.');
          },      
          error : function(e) {
                console.error(e);
          }
        });
      });
			
        // 58.181.28.53:11199/menu/getAllMenu(GET) // addMenu(POST)
    
          //좌측 상단 뒤로가기 버튼
          $('.back_btn').on('click', function(){
            window.history.back();
          });
    </script>

    
</body>
</html>
